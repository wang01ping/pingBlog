(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{146:function(n,e,t){"use strict";t.r(e);var o=t(0),a=Object(o.a)({},(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h3",{attrs:{id:"虚拟dom的原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#虚拟dom的原理","aria-hidden":"true"}},[n._v("#")]),n._v(" 虚拟dom的原理")]),n._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[n._v("通俗讲法")]),n._v(" "),t("p",[n._v("js对象模拟真实的dom，然后用虚拟dom的diff方法来最小化更新真实的DOM")])]),n._v(" "),t("p",[n._v("要了解snabbdom的话有必要先去github上先了解下snabbdom： https://github.com/snabbdom/snabbdom")]),n._v(" "),t("p",[n._v("核心代码:\n"),t("img",{attrs:{src:"https://images2018.cnblogs.com/blog/1048550/201807/1048550-20180701161550123-1194170923.png",alt:"核心代码"}})]),n._v(" "),t("p",[n._v("这里可以看到列出来的两个主要的核心函数，即h()函数和patch()函数，我们先来看下h()函数：")]),n._v(" "),t("p",[n._v("h函数\n"),t("img",{attrs:{src:"https://images2018.cnblogs.com/blog/1048550/201807/1048550-20180701162713295-1547393320.png",alt:"ss"}})]),n._v(" "),t("h3",{attrs:{id:"最终转化为了json对象的虚拟dom"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#最终转化为了json对象的虚拟dom","aria-hidden":"true"}},[n._v("#")]),n._v(" 最终转化为了json对象的虚拟dom")]),n._v(" "),t("p",[n._v("patch函数")]),n._v(" "),t("p",[n._v("patch函数的执行分为两个阶段，两次传递的参数都是两个")]),n._v(" "),t("p",[n._v("第一阶段为虚拟dom的第一次渲染，传递的两个参数分别是放真实DOM的container和生成的vnode，此时patch函数的作用是用来将初次生成的真实DOM结构挂载到指定的container上面。")]),n._v(" "),t("p",[n._v("第二阶段传递的两个参数分别为vnode和newVnode，此时patch函数的作用是使用diff算法对比两个参数的差异，进而更新参数变化的DOM节点；")]),n._v(" "),t("p",[n._v("可以发发现h函数和patch函数在cnabbdom中实现vdom到真实DOM的转化起到了至关重要的作用，那么还有一个很重要的环节，patch函数中是怎么样实现对比两个vnode从而实现对真实DOM的更新的呢，这里还要提一下snabbdom的另外一个核心算法，即diff算法。")]),n._v(" "),t("p",[n._v("diff算法")]),n._v(" "),t("p",[n._v("其实在我们日常开发中我们都在接触类似与diff算法的一些软件，比如svn可以看到当前代码和svn服务器上代码的不同之处，再如Beyond Compare这款软件也可以为我们指出两个对比文件的不同之处")]),n._v(" "),t("p",[n._v("但是此处是如何实现对vnode的对比的呢？参考以下代码：")]),n._v(" "),t("blockquote",[t("p",[n._v("function updateChildren(vnode, newVnode) {      // 创建对比函数\nvar children = vnode.children || []"),t("br"),n._v("\nvar newChildren = newVnode.children || []")])]),n._v(" "),t("pre",[t("code",[n._v("children.forEach(function(childrenVnode, index) {\n    var newChildVnode = newChildren[index]  // 首先拿到对应新的节点\n    if (childrenVnode.tag === newChildVnode.tag) {    // 判断节点是否相同\n        updateChilren(childrenVnode, newChildVnode)   // 如果相同执行递归，深度对比节点\n    } else {\n        repleaseNode(childrenVnode, newChildVnode)    // 如果不同则将旧的节点替换成新的节点\n    }\n})\n")])]),n._v(" "),t("p",[n._v("}")]),n._v(" "),t("p",[n._v("function repleaseNode(vnode, newVnode) {    // 节点替换函数\nvar elem = vnode.elem\nvar newEle = createElement(newVnode)\n}")]),n._v(" "),t("h3",{attrs:{id:"推荐链接-virtual-dom-前世今生"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#推荐链接-virtual-dom-前世今生","aria-hidden":"true"}},[n._v("#")]),n._v(" 推荐链接 "),t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/35876032",target:"_blank",rel:"noopener noreferrer"}},[n._v("virtual Dom 前世今生"),t("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=a.exports}}]);